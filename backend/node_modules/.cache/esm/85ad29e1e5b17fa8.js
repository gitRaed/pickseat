"use strict";;let getUserData,updateDbUser,deleteDbUser,authDbEmail,statusDb,decrypt;_e5b‍.x([["getUser",()=>getUser],["updateUser",()=>updateUser],["deleteUser",()=>deleteUser],["authCode",()=>authCode],["authCodeEmail",()=>authCodeEmail],["banCode",()=>banCode],["suspendCode",()=>suspendCode],["normalCode",()=>normalCode]]);_e5b‍.w("../dataAccessLayer/requete_data.mjs",[["getUserData",["getUserData"],function(v){getUserData=v}],["updateDbUser",["updateDbUser"],function(v){updateDbUser=v}],["deleteDbUser",["deleteDbUser"],function(v){deleteDbUser=v}],["authDbEmail",["authDbEmail"],function(v){authDbEmail=v}],["statusDb",["statusDb"],function(v){statusDb=v}]]);_e5b‍.w("./service/crypter.mjs",[["decrypt",["decrypt"],function(v){decrypt=v}]]);













       function getUser() {

    return getUserData().then((result) => {
        
        for(let i = 0, n = result.length; i < n; i++) {
            result[i].motDePasse = 'null';
        }
        return result;
    });
}

       function updateUser(id, nom, prenom, email, numero, typeUser) {


    return updateDbUser(id, nom, prenom, email, numero, typeUser);
}

       function deleteUser(id) {

    return deleteDbUser(id);
}

       function authCode(email, motDePasse) {

    let data = {
        auth : false,
    };

    // check le mot de passe et l'email
    return getUserData().then( (result) => {

        for (let i = 0, n  = result.length; i < n && !data.auth; i++) {

            result[i].motDePasse = decrypt(result[i].motDePasse);

            if(result[i].email === email && result[i].motDePasse === motDePasse) {
                data.auth = true;
                data.id = result[i].id_utilisateur;
                data.nom = result[i].nom;
                data.prenom = result[i].prenom;
                data.email = result[i].email;
                data.numero = result[i].numero;
                data.typeUser = result[i].typeUser;
            }
                
        }
        return data;
    });
}

       async function authCodeEmail(email) {

    let data = {
        auth: false
    };

    const verif = await authDbEmail(email);

    for(let i = 0, n = verif.length; i < n; i++){

        if (verif[i].email === email) {
            data.auth = true;
        
        }
    }

    return data;

}

       function banCode(id) {

    let status_compte = "Banni";

    return statusDb(id, status_compte);
}

       function suspendCode(id) {

    let status_compte = "Suspendu";

    return statusDb(id, status_compte);
}

       function normalCode(id) {

    let status_compte = "Actif";

    return statusDb(id, status_compte);
}