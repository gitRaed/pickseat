"use strict";;let express,bodyParser,getUser,updateUser,deletUser;_063‍.x([["data",()=>route]]);_063‍.w("express",[["default",["express"],function(v){express=v}]]);_063‍.w("body-parser",[["default",["bodyParser"],function(v){bodyParser=v}]]);_063‍.w("../../serviceLayer/code_data.mjs",[["getUser",["getUser"],function(v){getUser=v}],["updateUser",["updateUser"],function(v){updateUser=v}],["deletUser",["deletUser"],function(v){deletUser=v}]]);







const route = express.Router();


route.use(function (req, res, next) {
    // console.log("Request", req.url, req.body, req.method);
    res.header("Access-Control-Allow-Origin", "*");
    res.header("Access-Control-Allow-Headers", "Origin, X-Requested-With, Content-Type, Accept");
    if (req.method === 'OPTIONS') {
        res.end();
    } else {
        next();
    }
});
route.use(bodyParser.urlencoded({
    extended: true
}));
route.use(express.json());



route.get("/getData", async function (req, res) {

    res.status(200);
    getUser().then((result) => {
        res.send(result);
    });

});

route.post('/updateData', async function (req, res) {

    const id = req.body.id;
    const nom = req.body.nom;
    const prenom = req.body.prenom;
    const email = req.body.email;
    const numero = req.body.numero;
    const typeUser = req.body.typeUser;
    const motDePasse = req.body.motDePasse;

    res.status(200);

    // console.log(id, nom, prenom, email, numero, typeUser, motDePasse);
    updateUser(id, nom, prenom, email, numero, typeUser, motDePasse).then(() => 
        res.json({
            message: 'Donnée reçues ' + nom + ' ' + prenom
        }));
    
});

route.post('/deleteData', async function (req, res) {

    const id = req.body.id;
    const nom = req.body.nom;
    const prenom = req.body.prenom;

    res.status(200);

    deletUser(id).then(() => 
        res.json({
            message: 'Utilisateur ' + nom + ' ' + prenom + ' supprimé !'
        }));
});




